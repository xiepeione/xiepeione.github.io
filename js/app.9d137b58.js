(function(e){function t(t){for(var o,c,a=t[0],l=t[1],u=t[2],d=0,p=[];d<a.length;d++)c=a[d],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&p.push(i[c][0]),i[c]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);s&&s(t);while(p.length)p.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,a=1;a<n.length;a++){var l=n[a];0!==i[l]&&(o=!1)}o&&(r.splice(t--,1),e=c(c.s=n[0]))}return e}var o={},i={app:0},r=[];function c(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=o,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(n,o,function(t){return e[t]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var s=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"220b":function(e,t,n){},2395:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("img",{attrs:{alt:"Vue logo",src:n("cf05")}}),o("Facetion")],1)},r=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"face-recognition"},[e._m(0),n("div",{staticClass:"tip"},[n("div",{staticClass:"content-top"},[e._v("录制时，普通话大声读如下数字")]),n("div",{staticClass:"number"},e._l(e.numberArr,(function(t,o){return n("span",{key:o},[e._v(e._s(t))])})),0),e._m(1)]),n("div",{staticClass:"btn-wrapper"},[e.disabledFlag?n("div",{staticClass:"button disabled"},[e._v(" 已记住，进入录制（"+e._s(e.count)+"s） ")]):e._e(),n("div",{staticClass:"button",on:{click:e.showAgreement}},[e._v("已记住，进入录制")]),n("div",{staticClass:"button",on:{click:e.toFull}},[e._v("已记住，进入录制")])]),n("div",{staticClass:"support"},[e._v("由金融壹账通提供技术支持")]),n("button",{on:{click:e.agree}},[e._v("开始")])])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flow-diagram"},[n("div",{staticClass:"title"},[e._v("正确示意流程")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-bottom"},[e._v(" 正对屏幕 使用"),n("span",[e._v("前置摄像头")]),e._v("录制3~5秒 ")])}],l=(n("b680"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("99af"),n("a9ee")),u=n.n(l),s=n("93bf"),d=n.n(s),p={data:function(){return{verifycode:"",numberArr:["","","",""],count:3,disabledFlag:!0,timer:null,bucket:"",token:"",key:"",coordinates:"",regType:"",videoRecorder:null,stream:null,mimeType:"video/webm",fileExtension:"webm",ua:"",senceText:""}},computed:{},watch:{},created:function(){this.getlocationpoint(),window.parent.postMessage({type:"title",title:"人脸识别检测"},"*"),this.disabledFlag=!1},mounted:function(){var e=this;this.ua=navigator.userAgent.toLowerCase(),d.a.onchange((function(){!d.a.isFullscreen&&e.stream&&e.videoRecorder.stopRecording((function(){var t=document.querySelector("#recording-player");t.innerHTML="",e.stream.stop(),e.stream=null,e.videoRecorder=null}))}))},beforeDestroy:function(){clearInterval(this.timer)},methods:{createInput:function(){var e=document.getElementsByClassName("btn-wrapper")[0];if(!document.getElementById("videoInput")){var t=document.createElement("input");t.setAttribute("id","videoInput"),t.setAttribute("type","file"),t.setAttribute("capture","user"),t.setAttribute("accept","video/*"),t.classList.add("input"),t.style.opacity=0,t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.width="100%",t.style.height="100%",t.onchange=this.videoUpload,t.onclick=this.inputClick,e&&e.appendChild(t),document.getElementById("videoInput").click()}},clearInput:function(){var e=document.getElementById("videoInput");e&&e.remove()},inputClick:function(){},videoUpload:function(e){console.log(e.target);var t=e.target.files[0];this.dealVideoFile(t),this.clearInput()},dealVideoFile:function(e){e.size/1048576>20?console.log("录制视频文件过大，请重新录制"):(this.$store.commit("SET_VIDEO_FILE",e),document.getElementById("videoInput")&&(document.getElementById("videoInput").value=null),console.log("视频大小",(e.size/1048576).toFixed(2)+"M"),console.log("跳转到 上传进度页面======="))},countDown:function(){var e=this;this.timer=setInterval((function(){e.count--,e.count<=0&&(clearInterval(e.timer),e.disabledFlag=!1)}),1e3)},showAgreement:function(){this.$refs.agreement.open()},agree:function(){this.createInput()},toFull:function(){var e=document.querySelector("#recording-player");d.a.isEnabled&&d.a.request(e),this.recordVideo()},recordVideo:function(){var e=this,t=document.createElement("video"),n=document.getElementById("recording-player");t.controls=!1,t.muted=!0,t.autoplay=!0,t.playsinline=!0,t.style.width="100vw",t.style.height="100vh",n.appendChild(t),this.captureUserMedia({audio:!0,video:!0},(function(t){console.log(t),e.stream=t;var o=u()(t,{type:"video",disableLogs:!1,getNativeBlob:!1,ignoreMutedMedia:!1,mimeType:e.mimeType,video:document.querySelector("#recording-player video")});o.startRecording(),e.videoRecorder=o,setTimeout((function(){o.stopRecording((function(t){var i=null,r=o.getBlob(),c=e.getFileName();i=new File([r],c,{type:e.mimeType}),console.log("生成的视频文件======="),console.log(i),e.dealVideoFile(i),t=URL.createObjectURL(i),console.log("生成的视频url"),console.log(t),e.stream.stop(),e.stream=null,n.innerHTML="",d.a.exit()}))}),3e3)}),null)},captureUserMedia:function(e,t){navigator.mediaDevices.getUserMedia(e).then((function(e){t(e);var n=document.querySelector("#recording-player video");n.poster="",n.addEventListener("loadedmetadata",(function(){setTimeout((function(){"function"===typeof n.play&&n.play()}),500)}),!1),n.srcObject=e,"function"===typeof n.play&&n.play(),n.addEventListener("ended",(function(){n.srcObject=e}))})).catch((function(e){alert("录制失败！",e)}))},checkFull:function(){var e=document.fullscreenEnabled||window.fullScreen||document.webkitIsFullScreen||document.msFullscreenEnabled;return void 0===e&&(e=!1),e},getFileName:function(){var e=new Date,t=e.getUTCFullYear(),n=e.getUTCMonth(),o=e.getUTCDate(),i=e.getTime();return"RecordRTC-FaceRecg-"+t+n+o+"-"+i+"."+this.fileExtension},getlocationpoint:function(){var e=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(t){var n=t.coords;e.coordinates="X".concat(n.latitude,"Y").concat(n.longitude)}))}}},f=p,v=(n("6203"),n("2877")),m=Object(v["a"])(f,c,a,!1,null,null,null),g=m.exports,b={name:"App",components:{Facetion:g}},y=b,h=(n("7c55"),Object(v["a"])(y,i,r,!1,null,null,null)),_=h.exports;o["a"].config.productionTip=!1,new o["a"]({render:function(e){return e(_)}}).$mount("#app")},6203:function(e,t,n){"use strict";n("220b")},"7c55":function(e,t,n){"use strict";n("2395")},cf05:function(e,t,n){e.exports=n.p+"img/logo.82b9c7a5.png"}});
//# sourceMappingURL=app.9d137b58.js.map